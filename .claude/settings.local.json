{
  "permissions": {
    "allow": [
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTA3ODUsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.zfZVl3r-bs_aag_JYyt7VJWH7SwbWbfe80lwPOoESrs\")",
      "Bash(__NEW_LINE__ echo \"=== Testing /api/v1/ai/status ===\")",
      "Bash(__NEW_LINE__ echo -e \"\\n\\n=== Testing /api/v1/languages/translations/export ===\")",
      "Bash(__NEW_LINE__ echo -e \"\\n\\n=== Testing /api/v1/audit/clear (DELETE) ===\")",
      "Bash(__NEW_LINE__ echo \"=== Testing AI status from inside container ===\")",
      "Bash(/tmp/test_endpoints.sh)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTA3ODUsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.zfZVl3r-bs_aag_JYyt7VJWH7SwbWbfe80lwPOoESrs\" curl -s -X GET \"https://api.opsflux.io/api/v1/modules/\" -H \"Authorization: Bearer $TOKEN\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTE0ODEsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.ffBp1VXOt4_T_H_GrV7Gi_nIieRyC70y5KKaIPBWNnM\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTE0ODEsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.ffBp1VXOt4_T_H_GrV7Gi_nIieRyC70y5KKaIPBWNnM\" curl -s -w \"\\nHTTP Status: %{http_code}\\n\" -X GET \"https://api.opsflux.io/api/v1/storage/files\" -H \"Authorization: Bearer $TOKEN\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTE0ODEsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.ffBp1VXOt4_T_H_GrV7Gi_nIieRyC70y5KKaIPBWNnM\" curl -s -w \"\\nHTTP Status: %{http_code}\\n\" -X GET \"https://api.opsflux.io/api/v1/storage/list\" -H \"Authorization: Bearer $TOKEN\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTE2NTMsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.GL0lnMGaxdpK03htTu4MXaxWYkV6a12IIX0C33uE56c\")",
      "Bash(wc:*)",
      "Bash(COMPOSE_PROJECT_NAME=perenco-opsflux-gwxapr docker compose up:*)",
      "Bash(COMPOSE_PROJECT_NAME=perenco-opsflux-gwxapr docker compose exec:*)",
      "Bash(COMPOSE_PROJECT_NAME=perenco-opsflux-gwxapr docker compose:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTA3ODUsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.zfZVl3r-bs_aag_JYyt7VJWH7SwbWbfe80lwPOoESrs\" curl -s -X POST https://api.opsflux.io/api/v1/login/access-token -H \"Content-Type: application/x-www-form-urlencoded\" -d \"username=admin@opsflux.io\" -d \"password=RldgAHG%Jqlrq6T*RjsZq3is\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTI3NDQsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.RqPVNvzDHmO93LBLxk6MzN6QK_I0JbepXua8nqBd_Io\" curl -s -X GET \"https://api.opsflux.io/api/v1/settings/\" -H \"Authorization: Bearer $TOKEN\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTI3NDQsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.RqPVNvzDHmO93LBLxk6MzN6QK_I0JbepXua8nqBd_Io\" curl -s -X PUT \"https://api.opsflux.io/api/v1/settings/\" -H \"Authorization: Bearer $TOKEN\" -H \"Content-Type: application/json\" -d '{\"\"\"\"ai_provider\"\"\"\": \"\"\"\"openai\"\"\"\", \"\"\"\"redis_default_ttl\"\"\"\": 7200}')",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTMwOTMsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.9Vy2tnnEJa2ToYwbzu69EDWNdRYpo4xGTvOipGkvhXg\" curl -s -X GET \"https://api.opsflux.io/api/v1/settings/\" -H \"Authorization: Bearer $TOKEN\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTMwOTMsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.9Vy2tnnEJa2ToYwbzu69EDWNdRYpo4xGTvOipGkvhXg\" curl -s -X PATCH \"https://api.opsflux.io/api/v1/users/me\" -H \"Authorization: Bearer $TOKEN\" -H \"Content-Type: application/json\" -d '{\"\"full_name\"\":\"\"Test User\"\"}')",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTM2OTEsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.ge1mo5bx_WObZHnE_5T2DzusidAYZXlePeTRgM2U5jo\" curl -v -X PATCH \"https://api.opsflux.io/api/v1/users/me\" -H \"Authorization: Bearer $TOKEN\" -H \"Content-Type: application/json\" -d '{\"\"\"\"full_name\"\"\"\":\"\"\"\"Test User\"\"\"\"}')",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTM2OTEsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.ge1mo5bx_WObZHnE_5T2DzusidAYZXlePeTRgM2U5jo\" curl -s -X PATCH \"https://api.opsflux.io/api/v1/users/me\" -H \"Authorization: Bearer $TOKEN\" -H \"Content-Type: application/json\" -d '{\"\"full_name\"\":\"\"Test User\"\"}')",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTM5NTQsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.1Pl7TRNERVss8XH-x8lXlwXb3_AsEGIjonAaBs7tnrA\" curl -v -X PATCH \"https://api.opsflux.io/api/v1/users/me\" -H \"Authorization: Bearer $TOKEN\" -H \"Content-Type: application/json\" -d '{\"\"full_name\"\":\"\"Test User\"\"}')",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTM5NTQsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.1Pl7TRNERVss8XH-x8lXlwXb3_AsEGIjonAaBs7tnrA\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE4MTM5NTQsInN1YiI6IjNiYzczZmZlLTYyMmMtNDg3OS04MWQ0LWJiYTA0Zjg1ZWE3OSIsInR5cGUiOiJhY2Nlc3MifQ.1Pl7TRNERVss8XH-x8lXlwXb3_AsEGIjonAaBs7tnrA\" curl -s -X GET \"https://api.opsflux.io/api/v1/settings/\" -H \"Authorization: Bearer $TOKEN\")",
      "Bash(echo \"=== Testing AI status endpoint ===\" curl -s -w \"\\nHTTP Status: %{http_code}\\n\" -X GET \"https://api.opsflux.io/api/v1/ai/status\" -H \"Authorization: Bearer $TOKEN\")",
      "Bash(echo -e \"\\n\\n=== Testing Audit logs endpoint ===\" curl -s -w \"\\nHTTP Status: %{http_code}\\n\" -X GET \"https://api.opsflux.io/api/v1/audit/?skip=0&limit=2\" -H \"Authorization: Bearer $TOKEN\")",
      "Bash(echo -e \"\\n\\n=== Testing Translations export endpoint ===\" curl -s -w \"\\nHTTP Status: %{http_code}\\n\" -X GET \"https://api.opsflux.io/api/v1/languages/translations/export?namespace_code=core.settings&language_code=fr\" -H \"Authorization: Bearer $TOKEN\")",
      "Bash(__NEW_LINE__ echo \"=== Testing AI status endpoint ===\")",
      "Bash(timeout 30 docker logs:*)"
    ],
    "deny": [],
    "ask": []
  },
  "decisionMaking": {
    "autonomy": "full",
    "mode": "overnight_autonomous",
    "priorities": [
      "robustesse",
      "professionnalisme",
      "ergonomie",
      "visibilité d'utilisation",
      "intuitivité",
      "sécurité",
      "maintenabilité"
    ],
    "guidelines": {
      "makeDecisionsAutonomously": true,
      "commitAfterStableFeatures": true,
      "installDependenciesAsNeeded": true,
      "fixBugsWhenEncountered": true,
      "addErrorHandling": true,
      "documentComplexCode": true,
      "useTypeScriptStrictMode": true,
      "followExistingPatterns": true,
      "useDokployAPI": true
    }
  },
  "dokployAPI": {
    "url": "http://72.60.188.156:3000/api",
    "apiKeyEnvVar": "API_DOKPLOY",
    "usage": "Utiliser l'API Dokploy pour toutes les opérations Docker (logs, restart, status, etc.) au lieu des commandes docker directes. L'API key est dans .env"
  },
  "dockerOperations": {
    "CRITICAL_RULE": "TOUJOURS utiliser l'API Dokploy pour TOUTES les opérations Docker/Compose",
    "WHY": "Les commandes docker compose directes sans -p flag créent des containers avec des noms incorrects et corrompent le déploiement",
    "MANDATORY": [
      "JAMAIS exécuter 'docker compose build' sans -p perenco-opsflux-gwxapr",
      "JAMAIS exécuter 'docker compose up' sans -p perenco-opsflux-gwxapr",
      "JAMAIS exécuter 'docker compose down' sans -p perenco-opsflux-gwxapr",
      "JAMAIS exécuter 'docker compose restart' sans -p perenco-opsflux-gwxapr",
      "TOUJOURS vérifier docker ps pour s'assurer que SEULS les containers perenco-opsflux-gwxapr-* existent"
    ],
    "CORRECT_PROJECT_NAME": "perenco-opsflux-gwxapr",
    "CORRECT_COMMANDS": {
      "build": "docker compose -p perenco-opsflux-gwxapr build SERVICE",
      "up": "docker compose -p perenco-opsflux-gwxapr up -d SERVICE",
      "down": "docker compose -p perenco-opsflux-gwxapr down",
      "restart": "docker compose -p perenco-opsflux-gwxapr restart SERVICE",
      "logs": "docker compose -p perenco-opsflux-gwxapr logs SERVICE"
    },
    "ALTERNATIVE_PREFERRED": "Utiliser l'API Dokploy (clé dans .env: API_DOKPLOY) pour éviter tout risque d'erreur de nom de projet",
    "VERIFICATION": "Après chaque opération Docker, vérifier avec 'docker ps' qu'aucun container 'code-*' n'existe"
  }
}
