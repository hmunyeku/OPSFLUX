{
  "permissions": {
    "allow": [
      "Bash(ls:*)",
      "Bash(find:*)",
      "Bash(python -m pytest:*)",
      "Bash(docker cp:*)",
      "Bash(tee:*)",
      "Bash(python3:*)",
      "Bash(docker images:*)",
      "Bash(docker tag:*)",
      "Bash(docker image prune:*)",
      "Bash(docker run:*)",
      "Bash(docker compose logs:*)",
      "Bash(docker compose exec:*)",
      "Bash(docker compose:*)",
      "Bash(curl:*)",
      "Bash(PGPASSWORD=YBp44BSqEBvCXab psql:*)",
      "Bash(git status:*)",
      "Bash(grep:*)",
      "Bash(npm run build)",
      "Read(//etc/dokploy/compose/perenco-opsflux-gwxapr/**)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(docker exec:*)",
      "Bash(xargs:*)",
      "Bash(cat:*)",
      "Bash(docker ps:*)",
      "Bash(docker restart:*)",
      "Bash(docker logs:*)",
      "Bash(echo:*)",
      "WebFetch(domain:github.com)",
      "Bash(docker inspect:*)",
      "Bash(npm install:*)",
      "Bash(paste:*)",
      "Bash(git diff frontend/src/app/(auth)/login/components/user-auth-form.tsx)",
      "Bash(git diff:*)",
      "Bash(python scripts/create_company_tables.py:*)",
      "Bash(/etc/dokploy/compose/perenco-opsflux-gwxapr/code/backend/app/api/routes/companies.py )",
      "Bash(/etc/dokploy/compose/perenco-opsflux-gwxapr/code/backend/scripts/create_company_tables.py )",
      "Bash(/etc/dokploy/compose/perenco-opsflux-gwxapr/code/backend/scripts/register_third_parties_module.py)",
      "Bash(chmod:*)",
      "Bash(timeout 30 docker logs:*)",
      "Bash(for file in app/api/routes/*.py)",
      "Bash(do echo \"=== $file ===\" awk '/@require_permission/,/^def / {print NR\"\"\"\": \"\"\"\"$0}' \"$file\")",
      "Bash(python -m py_compile:*)",
      "Bash(sed:*)",
      "Bash(docker-compose:*)",
      "Read(//tmp/**)",
      "Bash(timeout 10 docker logs:*)",
      "Bash(timeout 10 docker compose:*)",
      "Bash(timeout 5 docker compose logs:*)",
      "WebFetch(domain:ui.shadcn.com)",
      "WebSearch",
      "Bash(timeout 5 docker logs:*)",
      "Bash(for file in /etc/dokploy/compose/perenco-opsflux-gwxapr/code/frontend/src/widgets/core/*.tsx)",
      "WebFetch(domain:app.opsflux.io)",
      "Bash(timeout 600 docker compose build:*)",
      "Bash(timeout 300 docker compose:*)",
      "Bash(awk:*)",
      "Bash(git pull:*)",
      "Bash(wget:*)",
      "Read(//etc/dokploy/**)",
      "Bash(docker image rm:*)",
      "Bash(tar:*)",
      "Bash(python:*)",
      "Bash(docker network connect:*)",
      "Bash(docker stop:*)",
      "Bash(docker rm:*)",
      "Bash(PGPASSWORD=YBp44BSqEBvCXab docker exec:*)",
      "Bash(pip install:*)",
      "Bash(/dev/null)",
      "Bash(./manual_test_report.sh:*)",
      "Bash(alembic revision:*)",
      "Bash(timeout 300 docker-compose build:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE0MTQyMDAsInN1YiI6ImRlM2E2ZDIzLWNjOGYtNDY2Mi1hZGI5LTRjYmU2YzdhNWI0NCIsInR5cGUiOiJhY2Nlc3MifQ.BwXiWLiUkrbg0zvF_WnADFIawpHR_l4rYb5B24CDrVc\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE0MTQzNjAsInN1YiI6ImRlM2E2ZDIzLWNjOGYtNDY2Mi1hZGI5LTRjYmU2YzdhNWI0NCIsInR5cGUiOiJhY2Nlc3MifQ.XTZ-xW_m5KQMZYpIQBZQclS5xz7Rvn_PAPU9Qm_PVqw\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE0MTQ0OTgsInN1YiI6ImRlM2E2ZDIzLWNjOGYtNDY2Mi1hZGI5LTRjYmU2YzdhNWI0NCIsInR5cGUiOiJhY2Nlc3MifQ.8ZPky-8JB8DsUnUrTKqvqR3Kdxb3fw5mEYVG4CRUeW4\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE0MTQ0OTgsInN1YiI6ImRlM2E2ZDIzLWNjOGYtNDY2Mi1hZGI5LTRjYmU2YzdhNWI0NCIsInR5cGUiOiJhY2Nlc3MifQ.8ZPky-8JB8DsUnUrTKqvqR3Kdxb3fw5mEYVG4CRUeW4\" docker exec perenco-opsflux-gwxapr-backend-1 curl -s -w \"\\nHTTP: %{http_code}\\n\" -H \"Authorization: Bearer $TOKEN\" http://localhost:8000/api/v1/third-parties/companies)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE0OTc1NDksInN1YiI6ImRlM2E2ZDIzLWNjOGYtNDY2Mi1hZGI5LTRjYmU2YzdhNWI0NCIsInR5cGUiOiJhY2Nlc3MifQ.Tr6XtjkrB7bJNgfCZMifI9lSCCNmmV9_UYlNO7l1rwA\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE0OTc1NDksInN1YiI6ImRlM2E2ZDIzLWNjOGYtNDY2Mi1hZGI5LTRjYmU2YzdhNWI0NCIsInR5cGUiOiJhY2Nlc3MifQ.Tr6XtjkrB7bJNgfCZMifI9lSCCNmmV9_UYlNO7l1rwA\" docker exec perenco-opsflux-gwxapr-backend-1 curl -s -H \"Authorization: Bearer $TOKEN\" \"http://localhost:8000/api/v1/modules/43fa93fb-abc0-40e4-96af-cabb728c2d81\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE0OTc2MjQsInN1YiI6ImRlM2E2ZDIzLWNjOGYtNDY2Mi1hZGI5LTRjYmU2YzdhNWI0NCIsInR5cGUiOiJhY2Nlc3MifQ.PvYkzNBX82YHQnrCP0eCDVQApnLG3g58DWfxOvYLuzc\" docker exec perenco-opsflux-gwxapr-backend-1 curl -s -H \"Authorization: Bearer $TOKEN\" \"http://localhost:8000/api/v1/modules/43fa93fb-abc0-40e4-96af-cabb728c2d81\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE0OTc2MjQsInN1YiI6ImRlM2E2ZDIzLWNjOGYtNDY2Mi1hZGI5LTRjYmU2YzdhNWI0NCIsInR5cGUiOiJhY2Nlc3MifQ.PvYkzNBX82YHQnrCP0eCDVQApnLG3g58DWfxOvYLuzc\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE0OTc2MjQsInN1YiI6ImRlM2E2ZDIzLWNjOGYtNDY2Mi1hZGI5LTRjYmU2YzdhNWI0NCIsInR5cGUiOiJhY2Nlc3MifQ.PvYkzNBX82YHQnrCP0eCDVQApnLG3g58DWfxOvYLuzc\" docker exec perenco-opsflux-gwxapr-backend-1 curl -s -H \"Authorization: Bearer $TOKEN\" \"http://localhost:8000/api/v1/modules?code=third_parties\")",
      "Bash(node scripts/build-modules.js:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjE0OTc2MjQsInN1YiI6ImRlM2E2ZDIzLWNjOGYtNDY2Mi1hZGI5LTRjYmU2YzdhNWI0NCIsInR5cGUiOiJhY2Nlc3MifQ.PvYkzNBX82YHQnrCP0eCDVQApnLG3g58DWfxOvYLuzc\" docker exec perenco-opsflux-gwxapr-backend-1 curl -s -w \"\\nHTTP: %{http_code}\\n\" -H \"Authorization: Bearer $TOKEN\" http://localhost:8000/api/v1/modules/third_parties/frontend/module.config.js)",
      "Bash(git restore:*)",
      "Bash(tree:*)",
      "Bash(git remote set-url:*)"
    ],
    "deny": [],
    "ask": []
  },
  "decisionMaking": {
    "autonomy": "full",
    "mode": "overnight_autonomous",
    "priorities": [
      "robustesse",
      "professionnalisme",
      "ergonomie",
      "visibilité d'utilisation",
      "intuitivité",
      "sécurité",
      "maintenabilité"
    ],
    "guidelines": {
      "makeDecisionsAutonomously": true,
      "commitAfterStableFeatures": true,
      "installDependenciesAsNeeded": true,
      "fixBugsWhenEncountered": true,
      "addErrorHandling": true,
      "documentComplexCode": true,
      "useTypeScriptStrictMode": true,
      "followExistingPatterns": true,
      "useDokployAPI": true
    }
  },
  "dokployAPI": {
    "url": "http://72.60.188.156:3000/api",
    "apiKeyEnvVar": "API_DOKPLOY",
    "usage": "Utiliser l'API Dokploy pour toutes les opérations Docker (logs, restart, status, etc.) au lieu des commandes docker directes. L'API key est dans .env"
  },
  "dockerOperations": {
    "CRITICAL_RULE": "TOUJOURS utiliser l'API Dokploy pour TOUTES les opérations Docker/Compose",
    "WHY": "Les commandes docker compose directes sans -p flag créent des containers avec des noms incorrects et corrompent le déploiement",
    "MANDATORY": [
      "JAMAIS exécuter 'docker compose build' sans -p perenco-opsflux-gwxapr",
      "JAMAIS exécuter 'docker compose up' sans -p perenco-opsflux-gwxapr",
      "JAMAIS exécuter 'docker compose down' sans -p perenco-opsflux-gwxapr",
      "JAMAIS exécuter 'docker compose restart' sans -p perenco-opsflux-gwxapr",
      "TOUJOURS vérifier docker ps pour s'assurer que SEULS les containers perenco-opsflux-gwxapr-* existent"
    ],
    "CORRECT_PROJECT_NAME": "perenco-opsflux-gwxapr",
    "CORRECT_COMMANDS": {
      "build": "docker compose -p perenco-opsflux-gwxapr build SERVICE",
      "up": "docker compose -p perenco-opsflux-gwxapr up -d SERVICE",
      "down": "docker compose -p perenco-opsflux-gwxapr down",
      "restart": "docker compose -p perenco-opsflux-gwxapr restart SERVICE",
      "logs": "docker compose -p perenco-opsflux-gwxapr logs SERVICE"
    },
    "ALTERNATIVE_PREFERRED": "Utiliser l'API Dokploy (clé dans .env: API_DOKPLOY) pour éviter tout risque d'erreur de nom de projet",
    "VERIFICATION": "Après chaque opération Docker, vérifier avec 'docker ps' qu'aucun container 'code-*' n'existe"
  }
}
